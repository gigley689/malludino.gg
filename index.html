<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZebbyAnnan.gg - Custom Dino Games</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Inter:wght@400;600;700;900&display=swap');

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Inter', Arial, sans-serif;
            background: #0a0e1a;
            color: white;
            text-align: center;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* ===== LANDING PAGE ===== */
        #landing-page {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        header {
            padding: 24px 20px;
            background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
            border-bottom: 1px solid rgba(56, 189, 248, 0.15);
        }

        header h1 {
            color: #38bdf8;
            font-size: 2.2rem;
            font-weight: 900;
            letter-spacing: 2px;
        }

        header p {
            color: #94a3b8;
            margin-top: 4px;
            font-size: 0.95rem;
        }

        .hero {
            padding: 60px 20px 40px;
            background: radial-gradient(ellipse at center top, rgba(56, 189, 248, 0.08) 0%, transparent 60%);
        }

        .hero h2 {
            font-size: 2rem;
            margin-bottom: 16px;
            font-weight: 700;
        }

        .hero p {
            color: #94a3b8;
            max-width: 520px;
            margin: 0 auto 32px;
            line-height: 1.6;
        }

        .play-btn {
            padding: 18px 48px;
            font-size: 1.15rem;
            font-weight: 700;
            border: none;
            background: linear-gradient(135deg, #22c55e, #16a34a);
            color: white;
            border-radius: 14px;
            cursor: pointer;
            transition: all 0.25s ease;
            box-shadow: 0 4px 24px rgba(34, 197, 94, 0.3);
            letter-spacing: 1px;
        }

        .play-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 32px rgba(34, 197, 94, 0.45);
        }

        .features {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 20px;
            padding: 20px;
        }

        .card {
            background: linear-gradient(135deg, #1e293b, #162032);
            padding: 24px 20px;
            border-radius: 16px;
            width: 240px;
            border: 1px solid rgba(56, 189, 248, 0.08);
            transition: transform 0.2s ease;
        }

        .card:hover { transform: translateY(-4px); }

        .card h3 { color: #38bdf8; margin-bottom: 8px; font-size: 1rem; }
        .card p { color: #94a3b8; font-size: 0.9rem; line-height: 1.5; }

        .about-section { padding: 40px 20px; }
        .about-section p {
            color: #94a3b8;
            max-width: 500px;
            margin: 0 auto;
            line-height: 1.6;
        }

        footer {
            padding: 20px;
            background: #1e293b;
            color: #64748b;
            font-size: 0.85rem;
            margin-top: auto;
        }

        /* ===== MODE SELECTION OVERLAY ===== */
        #mode-menu {
            display: none;
            position: fixed;
            inset: 0;
            z-index: 1000;
            background: rgba(10, 14, 26, 0.92);
            backdrop-filter: blur(12px);
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }

        #mode-menu.active { display: flex; }

        .mode-menu-inner {
            background: linear-gradient(145deg, #1a2235, #0f172a);
            border: 1px solid rgba(56, 189, 248, 0.15);
            border-radius: 24px;
            padding: 48px 40px;
            max-width: 520px;
            width: 90%;
            position: relative;
        }

        .mode-menu-inner h2 {
            font-family: 'Press Start 2P', monospace;
            color: #38bdf8;
            font-size: 1.1rem;
            margin-bottom: 8px;
        }

        .mode-menu-inner .subtitle {
            color: #64748b;
            font-size: 0.85rem;
            margin-bottom: 36px;
        }

        .mode-cards {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .mode-card {
            background: linear-gradient(145deg, #1e293b, #162032);
            border: 2px solid rgba(56, 189, 248, 0.1);
            border-radius: 18px;
            padding: 28px 24px;
            width: 200px;
            cursor: pointer;
            transition: all 0.25s ease;
            position: relative;
            overflow: hidden;
        }

        .mode-card:hover {
            border-color: #38bdf8;
            transform: translateY(-4px);
            box-shadow: 0 8px 32px rgba(56, 189, 248, 0.15);
        }

        .mode-card .mode-icon {
            font-size: 2.8rem;
            margin-bottom: 14px;
            display: block;
        }

        .mode-card .mode-name {
            font-weight: 700;
            font-size: 1.05rem;
            color: white;
            margin-bottom: 6px;
        }

        .mode-card .mode-desc {
            color: #94a3b8;
            font-size: 0.8rem;
            line-height: 1.4;
        }

        .mode-card.rishi-card {
            border-color: rgba(251, 191, 36, 0.2);
        }

        .mode-card.rishi-card:hover {
            border-color: #fbbf24;
            box-shadow: 0 8px 32px rgba(251, 191, 36, 0.15);
        }

        .mode-card .rishi-preview {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            object-fit: cover;
            margin-bottom: 14px;
            border: 3px solid #fbbf24;
            box-shadow: 0 0 16px rgba(251, 191, 36, 0.3);
        }

        .close-menu {
            position: absolute;
            top: 16px;
            right: 20px;
            background: none;
            border: none;
            color: #64748b;
            font-size: 1.4rem;
            cursor: pointer;
            padding: 4px 8px;
            transition: color 0.2s;
        }

        .close-menu:hover { color: white; }

        /* ===== GAME SCREEN ===== */
        #game-screen {
            display: none;
            position: fixed;
            inset: 0;
            z-index: 2000;
            background: #f7f7f7;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        #game-screen.active { display: flex; }

        .game-header {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 24px;
            background: white;
            border-bottom: 2px solid #e5e5e5;
            z-index: 10;
        }

        .game-header .back-btn {
            background: none;
            border: 2px solid #d1d5db;
            color: #535353;
            font-family: 'Press Start 2P', monospace;
            font-size: 0.55rem;
            padding: 8px 14px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .game-header .back-btn:hover {
            border-color: #535353;
            background: #f3f3f3;
        }

        .game-header .mode-label {
            font-family: 'Press Start 2P', monospace;
            font-size: 0.6rem;
            color: #535353;
        }

        .game-header .score-display {
            font-family: 'Press Start 2P', monospace;
            font-size: 0.7rem;
            color: #535353;
            letter-spacing: 2px;
        }

        #game-canvas {
            border-bottom: 2px solid #e5e5e5;
            background: #f7f7f7;
        }

        .game-watermark {
            position: absolute;
            bottom: 12px;
            right: 20px;
            font-family: 'Press Start 2P', monospace;
            font-size: 0.5rem;
            color: rgba(83, 83, 83, 0.35);
            pointer-events: none;
            z-index: 10;
        }

        /* ===== GAME OVER OVERLAY ===== */
        #game-over-overlay {
            display: none;
            position: absolute;
            inset: 0;
            background: rgba(247, 247, 247, 0.85);
            z-index: 20;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }

        #game-over-overlay.active { display: flex; }

        .game-over-box {
            text-align: center;
        }

        .game-over-box h2 {
            font-family: 'Press Start 2P', monospace;
            font-size: 1.2rem;
            color: #535353;
            margin-bottom: 12px;
        }

        .game-over-box .final-score {
            font-family: 'Press Start 2P', monospace;
            font-size: 0.8rem;
            color: #757575;
            margin-bottom: 8px;
        }

        .game-over-box .high-score-text {
            font-family: 'Press Start 2P', monospace;
            font-size: 0.6rem;
            color: #a3a3a3;
            margin-bottom: 24px;
        }

        .restart-btn {
            background: none;
            border: none;
            cursor: pointer;
            padding: 8px;
        }

        .restart-btn img,
        .restart-btn svg {
            width: 40px;
            height: 40px;
        }

        .restart-hint {
            font-family: 'Press Start 2P', monospace;
            font-size: 0.45rem;
            color: #a3a3a3;
            margin-top: 8px;
        }

        /* Responsive */
        @media (max-width: 520px) {
            .mode-menu-inner { padding: 32px 20px; }
            .mode-card { width: 160px; padding: 20px 16px; }
            .mode-card .mode-icon { font-size: 2.2rem; }
            header h1 { font-size: 1.6rem; }
            .hero h2 { font-size: 1.4rem; }
        }
    </style>
</head>
<body>
    <!-- ===== LANDING PAGE ===== -->
    <div id="landing-page">
        <header>
            <h1>amrita.gg</h1>
            <p>Dino Games by Amrita</p>
        </header>

        <section class="hero">
            <h2>Play Custom Dino Games</h2>
            <p>Experience unique versions of the classic Dino runner game with new themes, speed modes, and crazy obstacles!</p>
            <button class="play-btn" onclick="openModeMenu()">Play Now</button>
        </section>

        <section>
            <h2 style="margin-bottom: 20px;">What is Custom Dino?</h2>
            <p style="color: #94a3b8; max-width: 500px; margin: 0 auto 28px; line-height: 1.6;">
                Custom Dino games are advanced versions of the classic offline browser dinosaur game.
                Instead of the normal desert and cactus theme, custom versions include:
            </p>
            <div class="features">
                <div class="card">
                    <h3>Speed Modes</h3>
                    <p>Extreme speed levels and survival challenges.</p>
                </div>
                <div class="card">
                    <h3>New Themes</h3>
                    <p>Space, Jungle, Neon, and Dark mode environments.</p>
                </div>
                <div class="card">
                    <h3>New Obstacles</h3>
                    <p>Flying enemies, traps, and moving barriers.</p>
                </div>
                <div class="card">
                    <h3>Leaderboards</h3>
                    <p>SOON!.</p>
                </div>
            </div>
        </section>

        <section class="about-section">
            <h2 style="margin-bottom: 16px;">About ZebbyAnnan</h2>
            <p>
             zebbyannan.gg is created to bring fun, custom Dino gaming experiences to players worldwide.
                Every game mode is designed to be fast, exciting, and competitive.
            </p>
        </section>

        <footer>
            <p>&copy; 2026 amrita.gg | Custom Dino Games</p>
        </footer>
    </div>

    <!-- ===== MODE SELECTION MENU ===== -->
    <div id="mode-menu">
        <div class="mode-menu-inner">
            <button class="close-menu" onclick="closeModeMenu()">&times;</button>
            <h2>SELECT MODE</h2>
            <p class="subtitle">Choose your dino adventure</p>
            <div class="mode-cards">
                <div class="mode-card" onclick="startGame('normal')">
                    <span class="mode-icon">&#x1F996;</span>
                    <div class="mode-name">Normal Mode</div>
                    <div class="mode-desc">Classic chrome dino runner. Jump over cacti and dodge pterodactyls.</div>
                </div>
                <div class="mode-card rishi-card" onclick="startGame('rishi')">
                    <img src="assets/rishi-dino.jpg" alt="Rishi" class="rishi-preview">
                    <div class="mode-name" style="color: #fbbf24;">Rishi Mode</div>
                    <div class="mode-desc">Rishi runs wild! Custom dino with golden vibes and turbo speed.</div>
                </div>
            </div>
        </div>
    </div>

    <!-- ===== GAME SCREEN ===== -->
    <div id="game-screen">
        <div class="game-header">
            <button class="back-btn" onclick="exitGame()">&#9664; MENU</button>
            <span class="mode-label" id="mode-label">NORMAL MODE</span>
            <span class="score-display">HI <span id="hi-score-display">00000</span> &nbsp; <span id="score-display">00000</span></span>
        </div>
        <canvas id="game-canvas"></canvas>
        <div id="game-over-overlay">
            <div class="game-over-box">
                <h2>GAME OVER</h2>
                <div class="final-score" id="final-score">00000</div>
                <div class="high-score-text" id="high-score-text"></div>
                <button class="restart-btn" onclick="restartGame()">
                    <svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="20" cy="20" r="18" stroke="#535353" stroke-width="2.5" fill="none"/>
                        <path d="M14 16 L20 10 L26 16" stroke="#535353" stroke-width="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M20 10 L20 26" stroke="#535353" stroke-width="2.5" stroke-linecap="round"/>
                    </svg>
                </button>
                <div class="restart-hint">Press SPACE or tap to restart</div>
            </div>
        </div>
        <div class="game-watermark">By ANANDHUZ :)</div>
    </div>

    <script>
    // ===========================
    // MENU LOGIC
    // ===========================
    function openModeMenu() {
        document.getElementById('mode-menu').classList.add('active');
    }
    function closeModeMenu() {
        document.getElementById('mode-menu').classList.remove('active');
    }

    // ===========================
    // GAME ENGINE
    // ===========================
    let canvas, ctx;
    let gameMode = 'normal';
    let gameRunning = false;
    let gameOver = false;
    let score = 0;
    let hiScore = { normal: 0, rishi: 0 };
    let animFrameId = null;
    let lastTime = 0;
    let gameSpeed = 0;
    let acceleration = 0;
    let groundY = 0;

    // Dino
    let dino = {};
    let rishiImg = new Image();
    rishiImg.src = 'assets/rishi-dino.jpg';

    // Obstacles
    let obstacles = [];
    let obstacleTimer = 0;
    let minObstacleInterval = 0;

    // Clouds
    let clouds = [];

    // Ground lines
    let groundLines = [];

    // Input
    let jumpPressed = false;
    let duckPressed = false;

    // Particles (Rishi mode sparkle)
    let particles = [];

    // Night mode
    let nightMode = false;
    let nightTimer = 0;

    // Stars (night)
    let stars = [];

    function startGame(mode) {
        gameMode = mode;
        document.getElementById('mode-menu').classList.remove('active');
        document.getElementById('game-screen').classList.add('active');
        document.getElementById('mode-label').textContent = mode === 'rishi' ? 'RISHI MODE' : 'NORMAL MODE';
        if (mode === 'rishi') {
            document.getElementById('mode-label').style.color = '#b8860b';
        } else {
            document.getElementById('mode-label').style.color = '#535353';
        }

        canvas = document.getElementById('game-canvas');
        ctx = canvas.getContext('2d');
        resizeCanvas();
        initGame();
        gameRunning = true;
        gameOver = false;
        document.getElementById('game-over-overlay').classList.remove('active');
        lastTime = performance.now();
        animFrameId = requestAnimationFrame(gameLoop);
    }

    function resizeCanvas() {
        const w = Math.min(window.innerWidth, 900);
        const h = 280;
        canvas.width = w;
        canvas.height = h;
        groundY = h - 40;
    }

    function initGame() {
        score = 0;
        gameSpeed = gameMode === 'rishi' ? 7 : 6;
        acceleration = gameMode === 'rishi' ? 0.002 : 0.001;
        obstacles = [];
        obstacleTimer = 0;
        minObstacleInterval = 80;
        clouds = [];
        groundLines = [];
        particles = [];
        nightMode = false;
        nightTimer = 0;
        stars = [];
        jumpPressed = false;
        duckPressed = false;

        // Init dino
        dino = {
            x: 60,
            y: groundY,
            w: gameMode === 'rishi' ? 50 : 44,
            h: gameMode === 'rishi' ? 50 : 48,
            vy: 0,
            jumping: false,
            ducking: false,
            duckH: 30,
            gravity: 0.6,
            jumpForce: -13,
            grounded: true,
            legFrame: 0,
            legTimer: 0,
            blinkTimer: 0,
            blinkOn: false
        };

        // Init clouds
        for (let i = 0; i < 4; i++) {
            clouds.push({
                x: Math.random() * canvas.width + 100,
                y: 30 + Math.random() * 60,
                w: 50 + Math.random() * 40,
                speed: 0.5 + Math.random() * 0.5
            });
        }

        // Init ground lines
        for (let i = 0; i < 15; i++) {
            groundLines.push({
                x: Math.random() * canvas.width,
                w: 10 + Math.random() * 30
            });
        }

        // Init stars
        for (let i = 0; i < 20; i++) {
            stars.push({
                x: Math.random() * canvas.width,
                y: 10 + Math.random() * 80,
                r: 1 + Math.random() * 1.5,
                twinkle: Math.random() * Math.PI * 2
            });
        }

        updateScoreDisplay();
        updateHiScoreDisplay();
    }

    function gameLoop(timestamp) {
        if (!gameRunning) return;
        const dt = Math.min(timestamp - lastTime, 33) / 16.67; // normalize to ~60fps
        lastTime = timestamp;

        update(dt);
        draw();

        if (gameRunning && !gameOver) {
            animFrameId = requestAnimationFrame(gameLoop);
        }
    }

    function update(dt) {
        if (gameOver) return;

        // Score
        score += gameSpeed * 0.05 * dt;
        updateScoreDisplay();

        // Night mode toggle
        nightTimer += dt;
        if (nightTimer > 700) {
            nightMode = !nightMode;
            nightTimer = 0;
        }

        // Speed up
        gameSpeed += acceleration * dt;
        if (gameSpeed > (gameMode === 'rishi' ? 18 : 14)) {
            gameSpeed = gameMode === 'rishi' ? 18 : 14;
        }

        // Dino physics
        if (jumpPressed && dino.grounded && !dino.ducking) {
            dino.vy = dino.jumpForce;
            dino.jumping = true;
            dino.grounded = false;
        }

        if (!dino.grounded) {
            dino.vy += dino.gravity * dt;
            dino.y += dino.vy * dt;
            if (dino.y >= groundY) {
                dino.y = groundY;
                dino.vy = 0;
                dino.grounded = true;
                dino.jumping = false;
            }
        }

        dino.ducking = duckPressed && dino.grounded;

        // Leg animation
        dino.legTimer += dt;
        if (dino.legTimer > 6) {
            dino.legFrame = 1 - dino.legFrame;
            dino.legTimer = 0;
        }

        // Blink
        dino.blinkTimer += dt;
        if (dino.blinkTimer > 40) {
            dino.blinkOn = !dino.blinkOn;
            dino.blinkTimer = 0;
            if (dino.blinkOn) dino.blinkTimer = 36; // short blink
        }

        // Obstacles
        obstacleTimer += dt;
        if (obstacleTimer > minObstacleInterval / (gameSpeed * 0.15 + 0.5)) {
            spawnObstacle();
            obstacleTimer = 0;
        }

        for (let i = obstacles.length - 1; i >= 0; i--) {
            obstacles[i].x -= gameSpeed * dt;
            if (obstacles[i].x + obstacles[i].w < -20) {
                obstacles.splice(i, 1);
                continue;
            }

            // Collision
            let dinoBox = getDinoHitbox();
            let obsBox = {
                x: obstacles[i].x + 4,
                y: obstacles[i].y + 4,
                w: obstacles[i].w - 8,
                h: obstacles[i].h - 8
            };

            if (rectsOverlap(dinoBox, obsBox)) {
                triggerGameOver();
                return;
            }
        }

        // Clouds
        for (let c of clouds) {
            c.x -= c.speed * dt;
            if (c.x + c.w < 0) {
                c.x = canvas.width + 20 + Math.random() * 100;
                c.y = 30 + Math.random() * 60;
            }
        }

        // Ground lines
        for (let g of groundLines) {
            g.x -= gameSpeed * dt;
            if (g.x + g.w < 0) {
                g.x = canvas.width + Math.random() * 100;
                g.w = 10 + Math.random() * 30;
            }
        }

        // Stars
        for (let s of stars) {
            s.twinkle += 0.05 * dt;
        }

        // Particles (Rishi mode)
        if (gameMode === 'rishi') {
            if (Math.random() < 0.3) {
                particles.push({
                    x: dino.x + dino.w * 0.5 + (Math.random() - 0.5) * 20,
                    y: dino.y - dino.h * 0.5 + (Math.random() - 0.5) * 20,
                    vx: -2 - Math.random() * 2,
                    vy: (Math.random() - 0.5) * 1.5,
                    life: 20 + Math.random() * 15,
                    maxLife: 35,
                    size: 2 + Math.random() * 3
                });
            }
        }

        for (let i = particles.length - 1; i >= 0; i--) {
            particles[i].x += particles[i].vx * dt;
            particles[i].y += particles[i].vy * dt;
            particles[i].life -= dt;
            if (particles[i].life <= 0) {
                particles.splice(i, 1);
            }
        }
    }

    function spawnObstacle() {
        let type = Math.random();
        if (type < 0.5) {
            // Small cactus
            let h = 30 + Math.random() * 16;
            obstacles.push({
                type: 'cactus_small',
                x: canvas.width + 10,
                y: groundY - h,
                w: 18,
                h: h
            });
        } else if (type < 0.8) {
            // Tall cactus
            let h = 40 + Math.random() * 14;
            obstacles.push({
                type: 'cactus_tall',
                x: canvas.width + 10,
                y: groundY - h,
                w: 24,
                h: h
            });
        } else {
            // Bird / pterodactyl
            let birdY = groundY - 50 - Math.random() * 40;
            obstacles.push({
                type: 'bird',
                x: canvas.width + 10,
                y: birdY,
                w: 40,
                h: 26,
                wingFrame: 0,
                wingTimer: 0
            });
        }
    }

    function getDinoHitbox() {
        let h = dino.ducking ? dino.duckH : dino.h;
        let y = dino.ducking ? groundY - dino.duckH : dino.y - dino.h;
        return {
            x: dino.x + 6,
            y: y + 6,
            w: dino.w - 12,
            h: h - 12
        };
    }

    function rectsOverlap(a, b) {
        return a.x < b.x + b.w &&
               a.x + a.w > b.x &&
               a.y < b.y + b.h &&
               a.y + a.h > b.y;
    }

    function triggerGameOver() {
        gameOver = true;
        gameRunning = false;
        let s = Math.floor(score);
        if (s > hiScore[gameMode]) {
            hiScore[gameMode] = s;
            try { localStorage.setItem('dinoHi_' + gameMode, s); } catch(e) {}
        }
        document.getElementById('final-score').textContent = formatScore(s);
        document.getElementById('high-score-text').textContent = 'HI ' + formatScore(hiScore[gameMode]);
        document.getElementById('game-over-overlay').classList.add('active');
        updateHiScoreDisplay();
    }

    function restartGame() {
        document.getElementById('game-over-overlay').classList.remove('active');
        initGame();
        gameRunning = true;
        gameOver = false;
        lastTime = performance.now();
        animFrameId = requestAnimationFrame(gameLoop);
    }

    function exitGame() {
        gameRunning = false;
        gameOver = false;
        if (animFrameId) cancelAnimationFrame(animFrameId);
        document.getElementById('game-screen').classList.remove('active');
        document.getElementById('game-over-overlay').classList.remove('active');
    }

    // ===========================
    // DRAW
    // ===========================
    function draw() {
        // Background
        let bgColor = nightMode ? '#1a1a2e' : '#f7f7f7';
        ctx.fillStyle = bgColor;
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        // Stars (night)
        if (nightMode) {
            for (let s of stars) {
                let alpha = 0.4 + 0.4 * Math.sin(s.twinkle);
                ctx.fillStyle = `rgba(255, 255, 255, ${alpha})`;
                ctx.beginPath();
                ctx.arc(s.x, s.y, s.r, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        // Moon (night)
        if (nightMode) {
            ctx.fillStyle = '#e5e5e5';
            ctx.beginPath();
            ctx.arc(canvas.width - 80, 50, 20, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = bgColor;
            ctx.beginPath();
            ctx.arc(canvas.width - 72, 46, 16, 0, Math.PI * 2);
            ctx.fill();
        }

        // Clouds
        let cloudColor = nightMode ? '#2a2a4a' : '#e5e5e5';
        for (let c of clouds) {
            drawCloud(c.x, c.y, c.w, cloudColor);
        }

        // Ground
        let groundColor = nightMode ? '#888' : '#535353';
        ctx.fillStyle = groundColor;
        ctx.fillRect(0, groundY, canvas.width, 1.5);

        // Ground details
        ctx.fillStyle = nightMode ? '#555' : '#a0a0a0';
        for (let g of groundLines) {
            ctx.fillRect(g.x, groundY + 6 + Math.random() * 8, g.w, 1);
        }

        // Obstacles
        for (let obs of obstacles) {
            if (obs.type === 'bird') {
                drawBird(obs);
            } else {
                drawCactus(obs);
            }
        }

        // Particles (Rishi mode golden sparkle)
        if (gameMode === 'rishi') {
            for (let p of particles) {
                let alpha = p.life / p.maxLife;
                ctx.fillStyle = `rgba(251, 191, 36, ${alpha})`;
                ctx.beginPath();
                ctx.arc(p.x, p.y, p.size * alpha, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        // Dino
        drawDino();
    }

    function drawDino() {
        let h = dino.ducking ? dino.duckH : dino.h;
        let drawY = dino.ducking ? groundY - dino.duckH : dino.y - dino.h;

        if (gameMode === 'rishi') {
            // Draw Rishi image as the dino
            let imgSize = dino.ducking ? dino.duckH + 6 : dino.h + 6;
            let imgX = dino.x - 3;
            let imgY = drawY - 3;

            // Golden glow
            ctx.shadowColor = 'rgba(251, 191, 36, 0.5)';
            ctx.shadowBlur = 12;

            // Clip to rounded rect
            ctx.save();
            roundedRect(ctx, imgX, imgY, imgSize, imgSize, 8);
            ctx.clip();

            if (rishiImg.complete && rishiImg.naturalWidth > 0) {
                ctx.drawImage(rishiImg, imgX, imgY, imgSize, imgSize);
            } else {
                // Fallback
                ctx.fillStyle = '#fbbf24';
                ctx.fillRect(imgX, imgY, imgSize, imgSize);
            }

            ctx.restore();
            ctx.shadowColor = 'transparent';
            ctx.shadowBlur = 0;

            // Legs (simple running legs below image)
            if (dino.grounded && !dino.ducking) {
                ctx.strokeStyle = '#fbbf24';
                ctx.lineWidth = 3;
                ctx.lineCap = 'round';
                let legBase = groundY;
                let legTop = drawY + imgSize - 2;
                if (dino.legFrame === 0) {
                    ctx.beginPath();
                    ctx.moveTo(dino.x + 12, legTop);
                    ctx.lineTo(dino.x + 8, legBase);
                    ctx.stroke();
                    ctx.beginPath();
                    ctx.moveTo(dino.x + dino.w - 12, legTop);
                    ctx.lineTo(dino.x + dino.w - 4, legBase);
                    ctx.stroke();
                } else {
                    ctx.beginPath();
                    ctx.moveTo(dino.x + 12, legTop);
                    ctx.lineTo(dino.x + 16, legBase);
                    ctx.stroke();
                    ctx.beginPath();
                    ctx.moveTo(dino.x + dino.w - 12, legTop);
                    ctx.lineTo(dino.x + dino.w - 16, legBase);
                    ctx.stroke();
                }
            }

        } else {
            // Normal dino - pixel art style T-Rex
            let dinoColor = nightMode ? '#e5e5e5' : '#535353';
            ctx.fillStyle = dinoColor;

            if (dino.ducking) {
                // Ducking dino (wider, shorter)
                let dx = dino.x;
                let dy = groundY - dino.duckH;
                // Body
                ctx.fillRect(dx, dy + 4, 44, dino.duckH - 8);
                // Head
                ctx.fillRect(dx + 30, dy, 18, 14);
                // Eye
                ctx.fillStyle = nightMode ? '#1a1a2e' : '#f7f7f7';
                ctx.fillRect(dx + 42, dy + 3, 4, 4);
                ctx.fillStyle = dinoColor;
                // Legs
                if (dino.legFrame === 0) {
                    ctx.fillRect(dx + 6, groundY - 4, 6, 4);
                    ctx.fillRect(dx + 22, groundY - 4, 6, 4);
                } else {
                    ctx.fillRect(dx + 12, groundY - 4, 6, 4);
                    ctx.fillRect(dx + 28, groundY - 4, 6, 4);
                }
            } else {
                // Standing / running / jumping
                let dx = dino.x;
                let dy = drawY;
                // Body
                ctx.fillRect(dx + 4, dy + 12, 28, 28);
                // Head
                ctx.fillRect(dx + 14, dy, 30, 22);
                // Mouth gap
                ctx.fillStyle = nightMode ? '#1a1a2e' : '#f7f7f7';
                ctx.fillRect(dx + 32, dy + 14, 12, 4);
                ctx.fillStyle = dinoColor;
                // Eye
                ctx.fillStyle = nightMode ? '#1a1a2e' : '#f7f7f7';
                ctx.fillRect(dx + 34, dy + 4, 5, 5);
                // Blink
                if (dino.blinkOn) {
                    ctx.fillStyle = dinoColor;
                    ctx.fillRect(dx + 34, dy + 4, 5, 3);
                }
                ctx.fillStyle = dinoColor;
                // Tail
                ctx.fillRect(dx, dy + 16, 8, 6);
                ctx.fillRect(dx - 4, dy + 14, 6, 4);
                // Arms
                ctx.fillRect(dx + 26, dy + 26, 4, 10);
                ctx.fillRect(dx + 28, dy + 33, 4, 3);
                // Legs
                if (dino.grounded) {
                    if (dino.legFrame === 0) {
                        ctx.fillRect(dx + 8, dy + 38, 7, 12);
                        ctx.fillRect(dx + 22, dy + 38, 7, 8);
                    } else {
                        ctx.fillRect(dx + 8, dy + 38, 7, 8);
                        ctx.fillRect(dx + 22, dy + 38, 7, 12);
                    }
                } else {
                    // In air - legs together
                    ctx.fillRect(dx + 8, dy + 38, 7, 10);
                    ctx.fillRect(dx + 22, dy + 38, 7, 10);
                }
            }
        }
    }

    function drawCactus(obs) {
        let cc = nightMode ? '#7a9e7a' : '#2d5a27';
        ctx.fillStyle = cc;

        if (obs.type === 'cactus_small') {
            // Trunk
            ctx.fillRect(obs.x + 5, obs.y, 8, obs.h);
            // Arms
            ctx.fillRect(obs.x, obs.y + obs.h * 0.3, 6, 4);
            ctx.fillRect(obs.x, obs.y + obs.h * 0.3 - 8, 4, 10);
            ctx.fillRect(obs.x + 12, obs.y + obs.h * 0.45, 6, 4);
            ctx.fillRect(obs.x + 14, obs.y + obs.h * 0.45 - 6, 4, 8);
        } else {
            // Tall cactus
            ctx.fillRect(obs.x + 7, obs.y, 10, obs.h);
            // Left arm
            ctx.fillRect(obs.x, obs.y + obs.h * 0.25, 8, 5);
            ctx.fillRect(obs.x, obs.y + obs.h * 0.25 - 12, 5, 14);
            // Right arm
            ctx.fillRect(obs.x + 16, obs.y + obs.h * 0.4, 8, 5);
            ctx.fillRect(obs.x + 19, obs.y + obs.h * 0.4 - 10, 5, 12);
        }
    }

    function drawBird(obs) {
        obs.wingTimer = (obs.wingTimer || 0) + 1;
        if (obs.wingTimer > 10) {
            obs.wingFrame = 1 - (obs.wingFrame || 0);
            obs.wingTimer = 0;
        }

        let bc = nightMode ? '#aaa' : '#535353';
        ctx.fillStyle = bc;

        let bx = obs.x;
        let by = obs.y;

        // Body
        ctx.fillRect(bx + 6, by + 10, 28, 8);
        // Beak
        ctx.fillRect(bx + 34, by + 12, 8, 4);
        // Tail
        ctx.fillRect(bx, by + 8, 8, 4);

        // Wings
        if (obs.wingFrame === 0) {
            ctx.fillRect(bx + 10, by, 14, 10);
        } else {
            ctx.fillRect(bx + 10, by + 18, 14, 8);
        }
    }

    function drawCloud(x, y, w, color) {
        ctx.fillStyle = color;
        let h = w * 0.35;
        ctx.fillRect(x, y, w, h);
        ctx.fillRect(x + w * 0.15, y - h * 0.3, w * 0.4, h * 0.4);
        ctx.fillRect(x + w * 0.45, y - h * 0.5, w * 0.3, h * 0.6);
    }

    function roundedRect(ctx, x, y, w, h, r) {
        ctx.beginPath();
        ctx.moveTo(x + r, y);
        ctx.lineTo(x + w - r, y);
        ctx.quadraticCurveTo(x + w, y, x + w, y + r);
        ctx.lineTo(x + w, y + h - r);
        ctx.quadraticCurveTo(x + w, y + h, x + w - r, y + h);
        ctx.lineTo(x + r, y + h);
        ctx.quadraticCurveTo(x, y + h, x, y + h - r);
        ctx.lineTo(x, y + r);
        ctx.quadraticCurveTo(x, y, x + r, y);
        ctx.closePath();
    }

    // ===========================
    // SCORE
    // ===========================
    function formatScore(s) {
        return String(Math.floor(s)).padStart(5, '0');
    }

    function updateScoreDisplay() {
        document.getElementById('score-display').textContent = formatScore(score);
    }

    function updateHiScoreDisplay() {
        // Load from localStorage
        try {
            let stored = localStorage.getItem('dinoHi_' + gameMode);
            if (stored && parseInt(stored) > hiScore[gameMode]) {
                hiScore[gameMode] = parseInt(stored);
            }
        } catch(e) {}
        document.getElementById('hi-score-display').textContent = formatScore(hiScore[gameMode]);
    }

    // ===========================
    // INPUT
    // ===========================
    document.addEventListener('keydown', (e) => {
        if (e.code === 'Space' || e.code === 'ArrowUp') {
            e.preventDefault();
            if (gameOver) {
                restartGame();
                return;
            }
            jumpPressed = true;
        }
        if (e.code === 'ArrowDown') {
            e.preventDefault();
            duckPressed = true;
        }
    });

    document.addEventListener('keyup', (e) => {
        if (e.code === 'Space' || e.code === 'ArrowUp') {
            jumpPressed = false;
        }
        if (e.code === 'ArrowDown') {
            duckPressed = false;
        }
    });

    // Touch support
    let touchStartY = 0;
    document.getElementById('game-screen').addEventListener('touchstart', (e) => {
        if (gameOver) {
            restartGame();
            return;
        }
        touchStartY = e.touches[0].clientY;
        jumpPressed = true;
    }, { passive: true });

    document.getElementById('game-screen').addEventListener('touchend', () => {
        jumpPressed = false;
        duckPressed = false;
    }, { passive: true });

    document.getElementById('game-screen').addEventListener('touchmove', (e) => {
        let deltaY = e.touches[0].clientY - touchStartY;
        if (deltaY > 30) {
            duckPressed = true;
            jumpPressed = false;
        }
    }, { passive: true });

    // Resize
    window.addEventListener('resize', () => {
        if (canvas) resizeCanvas();
    });
    </script>
</body>
</html>
