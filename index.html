<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>malludino.gg</title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:'Montserrat',sans-serif;background:#f2f2f2;text-align:center;color:#222;}
h1{margin-top:40px;font-size:42px;letter-spacing:2px;}
.subtitle{font-size:14px;color:#666;margin-bottom:40px;}
#menu{margin-top:30px;}
.menuCard{background:white;width:90%;max-width:400px;margin:0 auto;padding:40px;border-radius:20px;box-shadow:0 20px 40px rgba(0,0,0,0.1);}
button{padding:14px 35px;margin:10px;font-size:15px;border-radius:40px;border:none;cursor:pointer;transition:0.25s;}
.primaryBtn{background:#222;color:white;}
.primaryBtn:hover{background:#000;transform:scale(1.05);}
.secondaryBtn{background:#e5e5e5;}
.secondaryBtn:hover{background:#d0d0d0;transform:scale(1.05);}
canvas{display:none;margin:40px auto;background:white;border-radius:10px;box-shadow:0 20px 50px rgba(0,0,0,0.15);width:95%;max-width:900px;height:auto;}
#score{display:none;font-weight:bold;margin-top:10px;}
#gameOver{display:none;margin-top:20px;}
#exitBtn{display:none;}
#leaderboard{margin-top:30px;}
#credits{margin-top:80px;padding:30px;font-size:14px;color:#777;}
.socialBtn{display:inline-block;margin-top:15px;padding:10px 25px;border-radius:30px;background:#000;color:white;text-decoration:none;transition:0.3s;}
.socialBtn:hover{transform:scale(1.1);background:#333;}
input{padding:10px;border-radius:20px;border:1px solid #ccc;width:80%;margin-bottom:20px;}
@media(max-width:600px){h1{font-size:28px;}button{width:80%;font-size:16px;}#credits{font-size:12px;}}
</style>
</head>

<body>

<h1>malludino.gg</h1>
<div class="subtitle">StylishDinos</div>

<div id="menu">
    <div class="menuCard">
        <h2>Select Mode</h2>
        <input id="usernameInput" placeholder="Enter Username">
        <button class="primaryBtn" onclick="startGame('normal')">Normal Mode</button>
        <button class="secondaryBtn" onclick="startGame('rishi')">Rishi Mode</button>
    </div>
</div>

<div id="leaderboard"></div>

<canvas id="gameCanvas" width="900" height="250"></canvas>
<div id="score">Score: 0</div>
<button id="exitBtn" class="secondaryBtn" onclick="backToMenu()">Exit</button>

<div id="gameOver">
    <h3>Game Umbi!</h3>
    <button class="primaryBtn" onclick="restartGame()">Restart</button>
    <button class="secondaryBtn" onclick="backToMenu()">Menu</button>
</div>

<div id="credits">
    Crafted by <b>ZebbyAnnanüòá</b><br>
    malludino.gg ¬© 2026
</div>

<script type="module">

/* üî• FIREBASE */
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getFirestore, collection, addDoc, getDocs, query, orderBy, limit } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyA9I4oU9khFGycZyIOvHcg3p6OrhSa1GzM",
  authDomain: "malludino-gg.firebaseapp.com",
  projectId: "malludino-gg",
  storageBucket: "malludino-gg.firebasestorage.app",
  messagingSenderId: "298331255490",
  appId: "1:298331255490:web:87440667c24a55c289c15b"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

/* üî• LEADERBOARD FUNCTIONS */
async function saveScore(username, score){
    await addDoc(collection(db, "scores"), {
        name: username,
        score: score,
        timestamp: Date.now()
    });
    loadLeaderboard();
}

async function loadLeaderboard(){
    const q = query(collection(db, "scores"), orderBy("score","desc"), limit(10));
    const snapshot = await getDocs(q);
    let html="<h3>üèÜ Global Leaderboard</h3>";
    snapshot.forEach(doc=>{
        const d=doc.data();
        html+=`<p>${d.name} - ${d.score}</p>`;
    });
    document.getElementById("leaderboard").innerHTML=html;
}

window.onload=loadLeaderboard;

/* üî• GAME CODE */
const canvas=document.getElementById("gameCanvas");
const ctx=canvas.getContext("2d");

let mode="normal";
let dinoY=170, velocity=0, gravity=0.7, jumping=false;
let speed=6, score=0, gameRunning=false;
let obstacles=[];

const rishiImg=new Image();
rishiImg.src="rishi-dino.png";

const jumpSound=new Audio("https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg");
const normalDeathSound=new Audio("ayoo.mp3");
const rishiDeathSound=new Audio("deatheffect.rishi.mp3");

function startGame(selectedMode){
    const username=document.getElementById("usernameInput").value;
    if(!username){ alert("Enter Username!"); return; }

    mode=selectedMode;
    obstacles=[];
    document.getElementById("menu").style.display="none";
    canvas.style.display="block";
    document.getElementById("score").style.display="block";
    document.getElementById("exitBtn").style.display="inline-block";
    document.getElementById("gameOver").style.display="none";
    gameRunning=true;
    gameLoop();
}

function jump(){
    if(!jumping && gameRunning){
        velocity=-14;
        jumping=true;
        jumpSound.currentTime=0;
        jumpSound.play();
    }
}
document.addEventListener("keydown",jump);
canvas.addEventListener("click",jump);

function drawGround(){
    ctx.beginPath();
    ctx.moveTo(0,210);
    ctx.lineTo(900,210);
    ctx.stroke();
}

function drawDino(){
    if(mode==="normal"){
        ctx.fillStyle="#2ecc71";
        ctx.fillRect(80,dinoY+10,45,30);
        ctx.fillRect(115,dinoY-5,25,25);
        ctx.fillStyle="#000";
        ctx.fillRect(132,dinoY+2,4,4);
    }else{
        ctx.drawImage(rishiImg,80,dinoY-10,55,55);
    }
}

function spawnObstacle(){
    obstacles.push({x:canvas.width+20,width:20,height:40});
}

function update(){
    ctx.clearRect(0,0,canvas.width,canvas.height);

    velocity+=gravity;
    dinoY+=velocity;
    if(dinoY>=170){dinoY=170;jumping=false;}

    if(obstacles.length===0 || obstacles[obstacles.length-1].x<canvas.width-300)
        spawnObstacle();

    for(let i=0;i<obstacles.length;i++){
        obstacles[i].x-=speed;
        ctx.fillRect(obstacles[i].x,210-obstacles[i].height,
                     obstacles[i].width,obstacles[i].height);

        if(obstacles[i].x<120 && obstacles[i].x+20>80 && dinoY>170){
            endGame();
        }
    }

    if(obstacles.length>0 && obstacles[0].x<-50){
        obstacles.shift();
        score++;
        document.getElementById("score").innerText="Score: "+score;
    }

    drawGround();
    drawDino();
}

function gameLoop(){
    if(!gameRunning)return;
    update();
    requestAnimationFrame(gameLoop);
}

function endGame(){
    gameRunning=false;
    document.getElementById("gameOver").style.display="block";

    const username=document.getElementById("usernameInput").value;
    saveScore(username,score);

    if(mode==="normal") normalDeathSound.play();
    else rishiDeathSound.play();
}

function restartGame(){
    obstacles=[];dinoY=170;velocity=0;score=0;
    document.getElementById("score").innerText="Score: 0";
    document.getElementById("gameOver").style.display="none";
    gameRunning=true;
    gameLoop();
}

function backToMenu(){
    gameRunning=false;
    obstacles=[];dinoY=170;velocity=0;score=0;
    document.getElementById("score").style.display="none";
    document.getElementById("exitBtn").style.display="none";
    document.getElementById("gameOver").style.display="none";
    canvas.style.display="none";
    document.getElementById("menu").style.display="block";
    loadLeaderboard();
}

</script>
</body>
</html>
